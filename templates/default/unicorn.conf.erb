# Dynamically generated by Chef on <%= node["fqdn"] %>
# Local modifications will be overwritten by Chef.
description "unicorn for <%= @app_name %>"

start on (local-filesystems and net-device-up IFACE=eth0)
stop on runlevel [!12345]

env HOME="/tmp"

pre-start script
  mkdir -p "<%= File.dirname(@socket) %>"
  chown -R <%= @nginx_user %>:<%= @nginx_group %> "<%= File.dirname(@socket) %>"
end script

respawn

exec start-stop-daemon --start --chdir "<%= @app_path %>" --exec <%= @bundler ? "#{@bundle_command} exec " : '' %>unicorn_rails -- -E <%= @rails_env %> -c "/etc/unicorn/<%= @app_name %>.rb"
